# ============================================================================
# TAUTULLI CURATED PLEX COLLECTION - CONFIGURATION FILE
# ============================================================================
# This configuration file controls all aspects of the Tautulli Curated Collection
# automation system. Update the values below with your actual credentials and
# preferences.
# ============================================================================

# ============================================================================
# SCRIPT EXECUTION CONTROL
# ============================================================================
# Control which scripts run when the main script is triggered by Tautulli.
# Set to 'true' to enable, 'false' to disable.
# ============================================================================
scripts_run:
  # Step 1: Recently Watched Collection
  # Generates recommendations for "Based on your recently watched movie" 
  # and "Change of Taste" collections (runs first, smaller/quicker)
  run_recently_watched_collection: true
  
  # Step 2: Plex Duplicate Cleaner
  # Scans Plex library for duplicate movies and removes lower quality versions
  # (runs second, after Recently Watched Collection)
  run_plex_duplicate_cleaner: true
  
  
  # Step 3: Radarr Monitor Confirm
  # Checks monitored movies in Radarr and unmonitors those already in Plex
  # (runs third, before main pipeline)
  run_radarr_monitor_confirm_plex: true
  
  # Step 3b: Sonarr Duplicate Cleaner
  # Scans Plex TV shows library for duplicate episodes and removes lower quality versions
  # (runs after Radarr Monitor Confirm)
  run_sonarr_duplicate_cleaner: true
  
  # Step 3c: Sonarr Monitor Confirm
  # Checks monitored episodes in Sonarr and unmonitors those already in Plex
  # (runs after Sonarr Duplicate Cleaner)
  run_sonarr_monitor_confirm_plex: true
  
  # Step 3d: Sonarr Search Monitored
  # Triggers a search for all missing monitored episodes in Sonarr
  # (runs after Sonarr Monitor Confirm)
  run_sonarr_search_monitored: true
  
  # Step 4: Immaculate Taste Collection
  # Main recommendation pipeline with points system
  # (runs fourth, main pipeline)
  run_immaculate_taste_collection: true

  # TV Support (Episode triggers)
  # When Tautulli triggers with media_type=episode, these control the TV pipeline.
  # Safe defaults are DISABLED.
  run_tv_immaculate_taste_collection: true   # TV Immaculate Taste pipeline (episode triggers)
  run_tv_collection_refresher: true          # TV Immaculate Taste collection refresher (adds shows to Plex collection)
  
  # Collection Refreshers (MANDATORY by default - these actually add movies to Plex!)
  # These scripts read the JSON files created by the main scripts and:
  # 1. Remove all existing items from the Plex collections
  # 2. Add all movies from JSON files to Plex collections in randomized order
  # 
  # IMPORTANT: Without these refreshers, movies are saved to JSON but NEVER added to Plex!
  # Set to 'true' to run automatically at the end of main script (recommended)
  # Set to 'false' to run independently during off-peak hours via bash scripts:
  #   - Recently Watched: ./src/scripts/run_recently_watched_collections_refresher.sh
  #   - Immaculate Taste: ./src/scripts/run_immaculate_taste_refresher.sh
  run_recently_watched_refresher: true   # Recently Watched Collection Refresher (MANDATORY)
  run_collection_refresher: true         # Immaculate Taste Collection Refresher (MANDATORY)

# ============================================================================
# TMDB CONFIGURATION (MANDATORY)
# ============================================================================
# TMDb is REQUIRED for:
# - Movie metadata lookups
# - Recommendation fallback when OpenAI is disabled/fails
#
# Even if you do NOT configure OpenAI/Google, the script still needs TMDb.
#
# Cost: TMDb is free to use (you just need to create an account to get an API key).
# ============================================================================
tmdb:
  api_key: "TMDB_API_KEY"              # Replace with your TMDB API key (REQUIRED)

# ============================================================================
# PLEX CONFIGURATION
# ============================================================================
plex:
  url: "http://localhost:32400"                    # Your Plex server URL
  token: "PLEX_TOKEN"                                # Replace with your Plex Token
  movie_library_name: "Movies"                       # Name of your Plex movie library
  tv_library_name: "TV Shows"                        # Name of your Plex TV shows library (can be customized, e.g., "Shows", "Television", etc.)
  collection_name: "Inspired by your Immaculate Taste"  # Name of the main Plex collection
  tv_collection_name: "Inspired by your Immaculate Taste (TV)"  # Name of the TV Plex collection
  
  # Duplicate Cleaner Settings
  delete_preference: "smallest_file"  # Which file to delete when duplicates found
                                     # Options: smallest_file, largest_file, newest, oldest
  preserve_quality: []               # Files with these keywords won't be deleted
                                     # Example: ["4K", "1080p"] to preserve high quality

# ============================================================================
# OPENAI CONFIGURATION
# ============================================================================
openai:
  api_key: "sk-proj-XXXXXXXXXXXXXXXXXXX"  # Optional (placeholder/blank disables OpenAI)
  model: "gpt-5.2-chat-latest"             # Optional (default: gpt-5.2-chat-latest if empty/null)

# ============================================================================
# RECOMMENDATION SETTINGS (Overall)
# ============================================================================
# This controls how many total suggestions the scripts generate per run.
# It is used by both OpenAI (if enabled) and the TMDb fallback.
# ============================================================================
recommendations:
  count: 50
  web_context_fraction: 0.30  # Optional (default: 0.30). Higher = more bias toward web/upcoming titles (used for Google context + OpenAI merge)

# ============================================================================
# GOOGLE CUSTOM SEARCH (Optional)
# ============================================================================
# If configured AND OpenAI is configured, the script will run a Google web search
# first and feed the top snippets into the OpenAI prompt as extra context.
#
# Notes:
# - This is used only to enrich the OpenAI prompt (not used by TMDb fallback).
# - If Google fails, the script will proceed with OpenAI without web context.
# - If OpenAI is disabled/missing, Google is skipped.
# ============================================================================
google:
  api_key: "GOOGLE_API_KEY"                # Optional (used only if OpenAI is enabled)
  search_engine_id: "GOOGLE_CSE_ID"        # Optional (Google Programmable Search Engine ID / cx)
  # Note: Google context size is derived from:
  #   recommendations.count * recommendations.web_context_fraction

# ============================================================================
# EMAIL ALERTS (Optional)
# ============================================================================
# Used by: `python3 -m tautulli_curated.tools.weekly_health_report --send-email`
#
# IMPORTANT:
# - Put real credentials in config/config.local.yaml (git-ignored), not here.
# - Gmail requires an App Password (not your normal Gmail password).
# ============================================================================
alerts:
  email:
    enabled: false
    smtp_host: "smtp.gmail.com"
    smtp_port: 587
    username: "your@gmail.com"
    app_password: "GMAIL_APP_PASSWORD"
    from_email: "your@gmail.com"
    to_emails:
      - "your@gmail.com"
    subject_prefix: "[Tautulli Curated]"
    send_only_on_problems: false

# ============================================================================
# RADARR CONFIGURATION
# ============================================================================
radarr:
  url: "http://localhost:7878"                      # Your Radarr server URL
  api_key: "RADARR_API_KEY"                         # Replace with your Radarr API key
  root_folder: "/path/to/Movies"                    # Root folder for movie downloads

  # Tag(s) to apply to added movies
  # - Single tag (string):
  #   tag_name: "recommended"
  # - Multiple tags (list):
  #   tag_name: ["movies", "curated"]
  tag_name: "recommended"
  # tag_name: ["movies", "curated"]
  
  quality_profile_id: 1                             # Quality profile ID (default: 1)

# ============================================================================
# SONARR CONFIGURATION
# ============================================================================
sonarr:
  url: "http://localhost:8989"                      # Your Sonarr server URL
  api_key: "SONARR_API_KEY"                         # Replace with your Sonarr API key
  root_folder: "/path/to/TV Shows"                  # Root folder for TV show downloads
  
  # Optional automation: add recommended shows to Sonarr and sync episode monitoring
  # Safe default is DISABLED.
  auto_download_recommendations: false
  
  # Tag(s) to apply to added series (for future curated collection features)
  # Option 1: Single tag (string)
  tag_name: "curated"
  # Option 2: Multiple tags (list) - uncomment and use this format instead:
  # tag_name: ["tv", "curated"]
  # Both formats are supported - choose the one that fits your needs
  
  quality_profile_id: 1                             # Quality profile ID (default: 1)

# ============================================================================
# OVERSEERR CONFIGURATION (Optional)
# ============================================================================
# Overseerr integration is optional. Leave api_key empty if not using Overseerr.
# ============================================================================
overseerr:
  url: "http://localhost:5055"         # Your Overseerr URL
  api_key: ""                          # Add your Overseerr API key here (optional)
